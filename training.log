2025-09-12 20:09:01.623914: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-09-12 20:09:01.625540: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-09-12 20:09:01.633128: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-09-12 20:09:01.657265: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1757700541.694438   45351 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1757700541.703885   45351 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1757700541.731201   45351 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1757700541.731238   45351 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1757700541.731243   45351 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1757700541.731245   45351 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-09-12 20:09:01.740372: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
/home/philip/.local/lib/python3.12/site-packages/matplotlib/projections/__init__.py:63: UserWarning: Unable to import Axes3D. This may be due to multiple versions of Matplotlib being installed (e.g. as a system package and as a pip package). As a result, the 3D projection is not available.
  warnings.warn("Unable to import Axes3D. This may be due to multiple versions of "
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1757700548.313298   45351 gl_context_egl.cc:85] Successfully initialized EGL. Major : 1 Minor: 5
I0000 00:00:1757700548.320095   45444 gl_context.cc:369] GL version: 3.2 (OpenGL ES 3.2 Mesa 24.2.8-1ubuntu1~24.04.1), renderer: Mesa Intel(R) Xe Graphics (TGL GT2)
INFO: Created TensorFlow Lite XNNPACK delegate for CPU.
W0000 00:00:1757700548.470866   45432 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
W0000 00:00:1757700548.547559   45439 inference_feedback_manager.cc:114] Feedback manager requires a model with a single signature inference. Disabling support for feedback tensors.
W0000 00:00:1757700548.605245   45437 landmark_projection_calculator.cc:186] Using NORM_RECT without IMAGE_DIMENSIONS is only supported for the square ROI. Provide IMAGE_DIMENSIONS or use PROJECTION_MATRIX.
Traceback (most recent call last):
  File "/home/philip/Github/WorkoutTracker/src/training/train.py", line 87, in main
    train_data, val_data = trainer.prepare_data(
                           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/philip/Github/WorkoutTracker/src/training/../training/trainer.py", line 139, in prepare_data
    print(f"  Frame skip: {metadata['frame_skip']}")
                           ~~~~~~~~^^^^^^^^^^^^^^
KeyError: 'frame_skip'
Warning: seaborn/matplotlib not available. Plots will be skipped.
============================================================
MULTITASK TCN TRAINING - 3 FPS PROCESSING
============================================================
Videos directory: data/raw
Labels directory: data/labels
Output directory: models
Target FPS: 3
Batch size: 16
Epochs: 5
Learning rate: 0.001
Balance classes: True
Multitask dataset builder (3 FPS) initialized:
  Window size: 30 frames
  Stride: 5 frames
  Original FPS: 30
  Target FPS: 3
  Frame skip: 10
  Exercise types: ['push-ups', 'squats', 'pull-ups', 'dips']
Multitask trainer (3 FPS) initialized:
  Target FPS: 3
  Experiment: tcn_3fps_final
  Output directory: models/tcn_3fps_final
Preparing multitask dataset with 3 FPS processing...
Building multitask dataset with 3 FPS processing...

Processing push-ups...
  Found 41 videos for push-ups
    Processing push-up_22.mp4...
    Processing push-up_4.mp4...
    Processing push-up_11.mp4...
    Processing push-up_1.mp4...
    Processing push-up_27.mp4...
  No sequences created for push-ups

Processing squats...
  Found 25 videos for squats
    Processing squat_9.mp4...
    Processing squat_21.mp4...
    Created 2 sequences from squat_21.mp4
    Processing squat_7.mp4...
    Processing squat_11.mp4...
    Processing squat_17.mp4...
  Total sequences for squats: 2

Processing pull-ups...
  Found 26 videos for pull-ups
    Processing pull-up_13.mp4...
    Created 3 sequences from pull-up_13.mp4
    Processing pull-up_19.mp4...
    Processing pull-up_9.mp4...
    Created 2 sequences from pull-up_9.mp4
    Processing pull-up_5.mp4...
    Processing pull-up_22.mp4...
  Total sequences for pull-ups: 5

Processing dips...
  Found 17 videos for dips
    Processing hyuge.mp4...
    Created 22 sequences from hyuge.mp4
    Processing dips_16.mp4...
    Created 1 sequences from dips_16.mp4
    Processing dips_17.mp4...
    Created 8 sequences from dips_17.mp4
    Processing dips_11.mp4...
    Created 2 sequences from dips_11.mp4
    Processing dips_6.mp4...
    Created 1 sequences from dips_6.mp4
  Total sequences for dips: 34

Dataset built successfully:
  Total sequences: 41
  Sequence shape: (41, 30, 25)
  Classification labels shape: (41,)
  Segmentation labels shape: (41, 30)
  Samples per exercise: {'squats': 2, 'pull-ups': 5, 'dips': 34}
Dataset prepared:
  Total samples: 41
  Input shape: (41, 30, 25)
  Processing FPS: 3
Training failed: 'frame_skip'
